function hello(a){alert("Hello, "+a)}hello("New user");
tic={numbers:"-1234567890".split(""),chars:"xluongabtic".split(""),message:null,startingPoint:function(){var a=window.location.search.replace("?","");console.log("shortURL: "+a);""!=a.length&&tic.getRealURL(a);document.getElementById("btConvert").addEventListener("click",tic.convertURL,!1);message=document.getElementById("messages")},convertURL:function(){var a="",b=document.getElementById("input-url");tic.validateUrl(b.value)?(a=tic.convertHashCode(b.value.hashCode()),tic.sendToServer(a,b.value)):
(message.setAttribute("class","alert alert-warning"),message.innerHTML="Your input-url is not validate")},validateUrl:function(a){return/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
sendToServer:function(a,b){xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&200==xmlhttp.status&&(response=xmlhttp.responseText,console.log("Response: "+response),0>response.indexOf("SUCCESS")?(message.setAttribute("class","alert alert-danger"),message.innerHTML="Cannot write to db"):(document.getElementById("short-url").value=window.location+"?"+a,message.setAttribute("class","alert alert-success"),
message.innerHTML="Long URL: "+b.length+" (cs). Short URL: "+a.length+" (cs). You saved: "+(b.length-a.length)+" (cs)",tic.copyToClipboard()))};xmlhttp.open("GET","php/insertURL.php?k="+a+"&v="+b,!0);xmlhttp.send()},getRealURL:function(a){console.log("Get real url for: "+a);xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState&&200==xmlhttp.status){response=xmlhttp.responseText;console.log("Response: "+
response);var b=response.split(";");2<b.length||0==b.length?(message.setAttribute("class","alert alert-danger"),message.innerHTML="Sorry. I could not get real url of "+a):window.location.replace(b[0])}};xmlhttp.open("GET","php/getRealURL.php?k="+a,!0);xmlhttp.send()},convertHashCode:function(a){a=String(a);for(var b="",c=0;c<a.length;c++)var d=tic.numbers.indexOf(a[c]),b=b+tic.chars[d];return b},copyToClipboard:function(){var a=document.getElementById("short-url").value;if(tic.validateUrl(a)){var b=
new ZeroClipboard(document.getElementById("btCopy"));b.on("ready",function(c){ZeroClipboard.setData("text/plain",a);b.on("aftercopy",function(b){message.setAttribute("class","alert alert-success");message.innerHTML="'"+a+"' is copied to your Clipboard!"})})}}};String.prototype.hashCode=function(){var a=0,b,c,d;if(0==this.length)return a;b=0;for(d=this.length;b<d;b++)c=this.charCodeAt(b),a=(a<<5)-a+c,a|=0;return 0>Number(a)?-Number(a):a};
document.addEventListener("DOMContentLoaded",tic.startingPoint,!1);